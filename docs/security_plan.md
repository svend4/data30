# План управления безопасностью, данными и соответствием

## 1) Оценка текущих рисков (угрозы, уязвимости, данные, роли)

### 1.1 Угрозы и сценарии
- **Утечка данных**: неправильные права доступа, утечка секретов, экспорт данных без маскирования.
- **Компрометация учетных записей**: слабые пароли, отсутствие MFA, фишинг.
- **Нарушение целостности**: несанкционированные изменения данных/моделей.
- **Сбой доступности**: перегрузка, отказ инфраструктуры, DDoS.
- **Риск цепочки поставок**: уязвимости в зависимостях/контейнерах.

### 1.2 Уязвимости и контрольные точки
- **Код/зависимости**: отсутствует системная SAST/DAST, нет регулярной проверки CVE.
- **Секреты**: возможное хранение ключей в переменных окружения без ротации.
- **Данные**: отсутствие унифицированной классификации PII/PHI и правил ретенции.
- **Доступы**: нет описания RBAC и минимальных привилегий по ролям.

### 1.3 Классы данных
- **PII**: ФИО, email, телефон, идентификаторы пользователей.
- **PHI (при наличии)**: медицинские показатели, диагнозы, назначения.
- **Служебные**: логи, метрики, конфигурация, артефакты обучения.

### 1.4 Роли и владельцы
- **Data Owner**: утверждает классификацию/ретенцию.
- **Security Lead**: определяет контрольные меры и аудит.
- **Platform/DevOps**: внедряет контроль доступа, секреты, мониторинг.
- **Engineering Manager**: внедряет SDLC практики и ревью.

## 2) Практики безопасной разработки (SDLC)

### 2.1 SAST/DAST
- **SAST**: сканирование кода на каждый PR (пример: Semgrep/SonarQube).
- **DAST**: еженедельный сканинг тестового стенда (пример: OWASP ZAP).
- **Политика блокировки**: критические уязвимости блокируют merge.

### 2.2 Управление секретами
- **Vault/Secret Manager**: все ключи/токены хранятся в защищенном хранилище.
- **Ротация**: регламент 90 дней или при инцидентах.
- **CI/CD**: секреты только через защищенные переменные/интеграции.

### 2.3 Code review и secure coding
- **Обязательное ревью**: минимум 1–2 апрувера для всех PR.
- **Security checklist**: проверка логирования, валидации, обработки ошибок.
- **Модули безопасности**: отдельные владельцы для криптографии, аутентификации, IAM.

## 3) Контроль доступа, журналирование и аудит

### 3.1 RBAC и least privilege
- **Роли**: разделить доступы для разработки, тестирования и продакшена.
- **Принцип минимальных привилегий**: только необходимые разрешения.
- **MFA**: обязательна для всех административных доступов.

### 3.2 Журналирование
- **Логи доступа**: кто/когда/что изменил.
- **Логи безопасности**: успешные/неуспешные попытки входа, изменения прав.
- **Хранение**: централизованная система логов с ограниченным доступом.

### 3.3 Аудит
- **Периодичность**: ежеквартальный аудит доступов и критических операций.
- **Артефакты**: протоколы аудита, отчеты исправлений.
- **Alerting**: уведомления о подозрительных действиях.

## 4) Политика хранения и обработки данных (PII/PHI)

### 4.1 Классификация
- **PII/PHI**: хранить раздельно от общих данных.
- **Уровни доступа**: отдельные разрешения на доступ к чувствительным данным.

### 4.2 Ретенция
- **PII/PHI**: хранение ограничено законодательно установленными сроками.
- **Логи**: хранение 6–12 месяцев, в зависимости от требований.
- **Архивирование**: автоматическое удаление после завершения срока.

### 4.3 Шифрование
- **В покое**: шифрование баз данных и файловых хранилищ.
- **В транзите**: TLS 1.2+ для всех сетевых соединений.
- **Ключи**: управляются через HSM/Vault, с ограниченным доступом.

## 5) План соответствия требованиям и чек-листы

### 5.1 GDPR
- Реестр обработки данных и основания обработки.
- Механизмы выполнения прав субъектов (удаление, экспорт).
- DPIA для высокорисковых процессов.

### 5.2 PCI DSS (если применимо)
- Сегментация сети для карточных данных.
- Регулярное сканирование на уязвимости.
- Ограничение доступа по принципу need-to-know.

### 5.3 ISO 27001
- Политики ИБ и управление рисками.
- Контроль доступа и обучение персонала.
- План реагирования на инциденты.

### 5.4 Чек-листы проверок
- **SDLC**: SAST, DAST, code review, зависимостные сканы.
- **Данные**: классификация, ретенция, шифрование.
- **Доступы**: RBAC, MFA, аудит.
- **Инциденты**: план реагирования, канал уведомлений.
