# Спецификация: оценки, рекомендации и модерация

## Цели
- Разделить оценку качества и оценку полезности, чтобы пользователи могли отдельно фиксировать соответствие продукта стандартам и практическую ценность.
- Привязать отзыв к подтвержденному использованию, чтобы повысить достоверность.
- Ввести уровни зрелости (прототип → стабильное → рекомендовано) для прозрачности жизненного цикла.
- Описать алгоритм ранжирования по сценариям использования, а не в целом по продукту.
- Добавить модерацию и анти‑спам механизмы.
- Создать UX‑модель «почему это рекомендовано» с объяснением факторов.

## 1. Разделение оценок: качество vs полезность

### Модель данных
- `quality_score` (1–5) — оценка качества: стабильность, соответствие стандартам, безопасность.
- `utility_score` (1–5) — оценка полезности: насколько хорошо решает задачу пользователя.
- `quality_tags` — чек‑лист критериев качества (например: «стабильно», «есть документация», «прошло аудит»).
- `utility_tags` — чек‑лист критериев полезности (например: «экономит время», «заменяет N инструментов»).

### UX
- Две независимые шкалы в карточке отзыва.
- Обязательное текстовое обоснование для каждого типа оценки (минимум 140 символов).
- Витрина продукта показывает отдельные средние значения и их динамику.

## 2. Подтвержденное использование

### Источники подтверждения
- Лог использования (интеграция/плагин/SDK) — факт запуска сценария.
- Подтвержденные покупки/подписки.
- Внутренние проекты/кейсы, привязанные к пользователю.

### Правила
- Отзыв можно оставить только при наличии `usage_proof` за последние 90 дней.
- Уровень доверия к отзыву повышается при многократном использовании (например, 5+ запусков).
- Если срок подтверждения истёк, отзыв сохраняется, но помечается как «не подтвержден свежим использованием».

## 3. Уровни зрелости

### Уровни
1. **Прототип** — ограниченный функционал, низкая стабильность, публично доступен.
2. **Стабильное** — базовая функциональность закрывает ключевые сценарии, стабильность выше порога.
3. **Рекомендовано** — высокий уровень стабильности, подтвержденная полезность, поддержка/документация.

### Критерии перехода
- Прототип → Стабильное:
  - Не менее 20 подтвержденных отзывов.
  - Средняя оценка качества ≥ 3.8.
  - Отсутствие критических инцидентов за последние 30 дней.
- Стабильное → Рекомендовано:
  - Не менее 50 подтвержденных отзывов.
  - Средняя оценка качества ≥ 4.2 и полезности ≥ 4.0.
  - Наличие документации и SLA (или эквивалентной поддержки).

## 4. Алгоритм ранжирования по сценариям

### Основные принципы
- Ранжирование строится отдельно для каждого сценария (например: «автоматизация отчётов», «моделирование», «анализ данных»).
- Итоговый балл сценария определяется агрегированием оценок только пользователей, которые отметили сценарий в отзыве.

### Формула (пример)
`scenario_rank = (quality_weight * quality_score_avg) + (utility_weight * utility_score_avg) + trust_bonus - spam_penalty`

Где:
- `quality_weight` = 0.45
- `utility_weight` = 0.45
- `trust_bonus` = 0.1 * `verified_usage_ratio`
- `spam_penalty` = 0.1 * `spam_risk_score`

### Дополнительно
- Учитывать количество подтвержденных отзывов в сценарии (минимальный порог для ранжирования).
- Вводить «коэффициент свежести» — отзывы старше 12 месяцев учитываются с коэффициентом 0.7.

## 5. Модерация и анти‑спам

### Анти‑спам правила
- Ограничение: не более 2 отзывов в сутки от одного пользователя.
- Автоматическое выявление повторяющихся шаблонов (N‑gram/семантическое сходство).
- Флаги риска: множественные отзывы с одного IP, аномальная частота, нет подтверждения использования.

### Модерация
- Статусы отзыва: `pending` → `approved` / `rejected`.
- Приоритетная проверка отзывов с высокими рисками.
- Логи модерации сохраняются (кто, когда, причина).

## 6. UX‑модель «почему это рекомендовано»

### Компоненты объяснения
- Топ‑3 причин (например: «Высокая полезность для сценария X», «Стабильное качество», «Высокий доверительный рейтинг»).
- Вклад факторов в итоговый балл (мини‑гистограмма или процентное распределение).
- Количество подтвержденных пользователей и сценариев.

### Пример текста
> Рекомендовано для сценария «Анализ данных» благодаря высокой полезности (4.6), стабильному качеству (4.4) и 82% подтвержденных отзывов.

## Метрики мониторинга
- Доля подтвержденных отзывов.
- Средняя оценка качества и полезности по сценариям.
- Количество спам‑отзывов, отклоненных модерацией.
- Доля продуктов в статусе «рекомендовано».

## 7. Поиск и рекомендации: цель, типы запросов, фильтры

### Цель поиска и рекомендаций
Поиск помогает пользователю быстро находить функции, модули и приложения, релевантные его задаче, а рекомендации помогают сократить выбор, предлагая наиболее подходящие варианты на основе контекста, поведения и похожих сценариев. В результате пользователь получает релевантные решения без необходимости разбираться в полном каталоге.

Рекомендации дополняют поиск, предлагая альтернативы и лучшие практики в рамках выбранного сценария: если пользователь ищет инструмент для автоматизации отчётов, система не только ранжирует результаты, но и подсказывает близкие сценарии и проверенные макросы.

### Типы пользовательских запросов
- **По цели**: «автоматизировать отчёты», «собрать витрину данных», «построить ML‑модель».
- **По функции**: «экспорт в CSV», «парсинг PDF», «автопланировщик задач».
- **По платформе**: «под Linux», «для Google Sheets», «встраивается в Slack».
- **По ограничениям**: «без оплаты», «офлайн», «SOC2/ISO», «без внешних API».

### Фильтры
- **Стоимость**: бесплатное / freemium / платное / enterprise.
- **Зрелость**: прототип / стабильное / рекомендовано.
- **Совместимость**: ОС, среда исполнения, зависимости, интеграции.
- **Категория**: аналитика, интеграции, автоматизация, ML/AI, безопасность.
- **Рейтинг**: средний `quality_score`, средний `utility_score`, доверительный рейтинг.

## 8. Логика релевантности и ранжирование

### Приоритеты релевантности
1. **Функции** — точное соответствие требуемым возможностям (features).
2. **Сценарии** — насколько продукт закрывает конкретный use‑case пользователя.
3. **Приложения** — соответствие платформе, зрелости и ограничениям.

### Ранжирование
- Основной скоринг строится по совпадению функций и сценариев, затем корректируется по ограничениям и зрелости.
- При равных очках применяется сортировка по рейтингу и подтверждённым отзывам.

### Таблица: тип запроса → результаты → критерии сортировки

| Тип запроса | Результаты | Критерии сортировки |
| --- | --- | --- |
| По цели | Сценарии и наборы продуктов под задачу | Совпадение сценария → полезность → зрелость |
| По функции | Продукты с нужными возможностями | Совпадение функций → качество → совместимость |
| По платформе | Продукты, интеграции и плагины | Совместимость → качество → полезность |
| По ограничениям | Только соответствующие требованиям продукты | Соответствие ограничениям → зрелость → рейтинг |

## 9. Рекомендации: типы и правила объяснимости

### Типы рекомендаций
- **Похожие сценарии**: предложения соседних use‑case для расширения задачи (например, после «автоматизация отчётов» → «мониторинг KPI»).
- **Альтернативы**: продукты с теми же функциями, но другой ценой/платформой/зрелостью.
- **Лучшие макросы**: макросы с максимальной полезностью и подтверждённым использованием.

### Правила объяснимости
- Показывать 2–3 причины: совпадение функций, соответствие сценариям, подтверждённые отзывы.
- Указывать ключевые ограничения, которые продукт покрывает (например, «работает офлайн»).
- Для макросов — показывать эффект («экономит 2 часа/неделю») и источник подтверждения.

## 10. UX‑прототип (текстовое описание)

**Экран поиска**
- Верхняя строка: поле поиска + чипы фильтров (стоимость, зрелость, совместимость, категория, рейтинг).
- Слева: блок «Сценарии» (подсказки по цели).
- Справа: результаты списка с быстрыми метками функций и зрелости.

**Карточка результата**
- Заголовок, тип (функция/модуль/приложение), рейтинг качества/полезности.
- Блок «Почему в выдаче»: 2–3 причины (совпадение функции, сценарий, ограничения).
- Кнопка «Похожие сценарии» и «Альтернативы».

**Блок рекомендаций**
- «Похожие сценарии» (горизонтальный список).
- «Альтернативы» (табличный список с сравнениями).
- «Лучшие макросы» (топ‑3 с показателем эффекта и подтверждением).
