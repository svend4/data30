# Спецификация: оценки, рекомендации и модерация

## Цели
- Разделить оценку качества и оценку полезности, чтобы пользователи могли отдельно фиксировать соответствие продукта стандартам и практическую ценность.
- Привязать отзыв к подтвержденному использованию, чтобы повысить достоверность.
- Ввести уровни зрелости (прототип → стабильное → рекомендовано) для прозрачности жизненного цикла.
- Описать алгоритм ранжирования по сценариям использования, а не в целом по продукту.
- Добавить модерацию и анти‑спам механизмы.
- Создать UX‑модель «почему это рекомендовано» с объяснением факторов.

## 1. Разделение оценок: качество vs полезность

### Модель данных
- `quality_score` (1–5) — оценка качества: стабильность, соответствие стандартам, безопасность.
- `utility_score` (1–5) — оценка полезности: насколько хорошо решает задачу пользователя.
- `quality_tags` — чек‑лист критериев качества (например: «стабильно», «есть документация», «прошло аудит»).
- `utility_tags` — чек‑лист критериев полезности (например: «экономит время», «заменяет N инструментов»).

### UX
- Две независимые шкалы в карточке отзыва.
- Обязательное текстовое обоснование для каждого типа оценки (минимум 140 символов).
- Витрина продукта показывает отдельные средние значения и их динамику.

## 2. Подтвержденное использование

### Источники подтверждения
- Лог использования (интеграция/плагин/SDK) — факт запуска сценария.
- Подтвержденные покупки/подписки.
- Внутренние проекты/кейсы, привязанные к пользователю.

### Правила
- Отзыв можно оставить только при наличии `usage_proof` за последние 90 дней.
- Уровень доверия к отзыву повышается при многократном использовании (например, 5+ запусков).
- Если срок подтверждения истёк, отзыв сохраняется, но помечается как «не подтвержден свежим использованием».

## 3. Уровни зрелости

### Уровни
1. **Прототип** — ограниченный функционал, низкая стабильность, публично доступен.
2. **Стабильное** — базовая функциональность закрывает ключевые сценарии, стабильность выше порога.
3. **Рекомендовано** — высокий уровень стабильности, подтвержденная полезность, поддержка/документация.

### Критерии перехода
- Прототип → Стабильное:
  - Не менее 20 подтвержденных отзывов.
  - Средняя оценка качества ≥ 3.8.
  - Отсутствие критических инцидентов за последние 30 дней.
- Стабильное → Рекомендовано:
  - Не менее 50 подтвержденных отзывов.
  - Средняя оценка качества ≥ 4.2 и полезности ≥ 4.0.
  - Наличие документации и SLA (или эквивалентной поддержки).

## 4. Алгоритм ранжирования по сценариям

### Основные принципы
- Ранжирование строится отдельно для каждого сценария (например: «автоматизация отчётов», «моделирование», «анализ данных»).
- Итоговый балл сценария определяется агрегированием оценок только пользователей, которые отметили сценарий в отзыве.

### Формула (пример)
`scenario_rank = (quality_weight * quality_score_avg) + (utility_weight * utility_score_avg) + trust_bonus - spam_penalty`

Где:
- `quality_weight` = 0.45
- `utility_weight` = 0.45
- `trust_bonus` = 0.1 * `verified_usage_ratio`
- `spam_penalty` = 0.1 * `spam_risk_score`

### Дополнительно
- Учитывать количество подтвержденных отзывов в сценарии (минимальный порог для ранжирования).
- Вводить «коэффициент свежести» — отзывы старше 12 месяцев учитываются с коэффициентом 0.7.

## 5. Модерация и анти‑спам

### Анти‑спам правила
- Ограничение: не более 2 отзывов в сутки от одного пользователя.
- Автоматическое выявление повторяющихся шаблонов (N‑gram/семантическое сходство).
- Флаги риска: множественные отзывы с одного IP, аномальная частота, нет подтверждения использования.

### Модерация
- Статусы отзыва: `pending` → `approved` / `rejected`.
- Приоритетная проверка отзывов с высокими рисками.
- Логи модерации сохраняются (кто, когда, причина).

## 6. UX‑модель «почему это рекомендовано»

### Компоненты объяснения
- Топ‑3 причин (например: «Высокая полезность для сценария X», «Стабильное качество», «Высокий доверительный рейтинг»).
- Вклад факторов в итоговый балл (мини‑гистограмма или процентное распределение).
- Количество подтвержденных пользователей и сценариев.

### Пример текста
> Рекомендовано для сценария «Анализ данных» благодаря высокой полезности (4.6), стабильному качеству (4.4) и 82% подтвержденных отзывов.

## Метрики мониторинга
- Доля подтвержденных отзывов.
- Средняя оценка качества и полезности по сценариям.
- Количество спам‑отзывов, отклоненных модерацией.
- Доля продуктов в статусе «рекомендовано».

## Целевые метрики эффективности и стабильности

### 1. Время настройки до первой ценности
- **TTV (time‑to‑value)**: целевой порог — до 7 календарных дней от регистрации до первого подтвержденного полезного действия.
- **TTFS (time‑to‑first‑scenario)**: до 24 часов от регистрации до первого запуска ключевого сценария.

### 2. Метрики конверсии (регистрация → активное использование)
- **Activation rate**: доля зарегистрировавшихся пользователей, которые выполнили минимум 1 ключевой сценарий за 7 дней.
- **Week‑1 retention**: доля активированных пользователей, повторивших ключевой сценарий на 2–7 день.
- **Activation‑to‑review**: доля активированных пользователей, оставивших подтвержденный отзыв в течение 30 дней.

### 3. Метрики стабильности
- **Аптайм**: ≥ 99.5% по ключевым пользовательским путям.
- **SLO по ошибкам**: доля ошибочных запросов (5xx) ≤ 0.5% в сутки.
- **Инциденты**: ≤ 2 инцидента уровня P1/P2 в месяц.

### 4. Методы измерения и периодичность
- **Сбор событий**: продуктовая аналитика (event‑лог), backend‑логи, статус‑мониторинг.
- **Источники**: аналитика событий (TTV/активация), APM/логирование (ошибки), мониторинг (аптайм).
- **Отчётность**:
  - Еженедельно — TTV, активация, ретеншн.
  - Ежемесячно — конверсия в отзыв, инциденты, аптайм, SLO по ошибкам.
